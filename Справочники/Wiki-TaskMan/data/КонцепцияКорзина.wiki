++ Концепция Корзина
[template: ШаблонСтраницыРазделаКонцепции]
Состояние: [В РАЗРАБОТКЕ]

+++Ссылки раздела
* ГлоссарийОператор


+++Содержание раздела

Заготовки для Корзина:
- Корзина это нода в корне дерева, создаваемая полностью кодом.
  - Создается в БД как нода, защищенная от удаления.
  - Иконка корзины должна быть добавлена в коллекцию иконок дерева.
  - Иконки элементов корзины используются обычные.
  - ноды элементов Корзины хранят объекты элементов обычно для дерва, в поле Tag.
- событие раскрытия Корзины перехватить в обработчике NodeExpanding() и вызывать функцию FillTrashCan().
- событие  NodeCollapsing() такое же, как везде, вставляет временную ноду.
- выборка всех объектов, помеченных в БД как удаленные
- выборка получения имени по ид элемента: SELECT title FROM Elements WHERE (id = ?);
- построение цепочки ид для каждого элемента
  - цепочка ид во время сеанса может измениться, когда пользователь переподчинит элементы.
    Поэтому цепочку не хранить постоянно, а вычислять на момент применения.
    И производные от нее данные - тоже.
- флаг, что предыдущие элементы в цепочке не были удалены.
  - он нужен в операции восстановления удаленного элемента, это происходит редко.
- кеш имен элементов по ид, размером 128 - 256 элементов.
 - он должен ускорить построение пути удаленного элемента, сократив количество обращений к БД.
 - применять только внутри групповых операций, не сохранять между ними.
- по цепочке ид получать путь к элементу, как цепочку имен элементов, разделенных / 
  - вопрос: где показать этот путь для выбранного в дереве удаленного элемента?
- добавить элементы в ноду Корзины с правильной иконкой, цветом, итп.
  - эту функцию взять из базового класса.
- Сортировать субноды корзины по убыванию даты последнего изменения элемента 
  - то есть, по дате удаления в корзину.
- каждой ноде элемента прицепить контекстное меню удаленного элемента.
- если у удаленного элемента parent = тоже удаленный элемент, можно их связывать в ноды прямо внутри Корзины.
  - тогда сворачивание-разворачивание нод не будет работать.
  - это можно сделать в отдельном диалоге-дереве просмотра Корзины. Но пока незачем это делать.
  - решение: идею отложить на потом.
- перед восстановлением элемента надо проверить, что элементы в цепочке до текущего элемента - все активные.
  Если это не так, показать пользователю окно предупреждения.




+++Материалы
