++ Процесс Завершение Приложения
[template: ШаблонСтраницыРазделаКонцепции]
Состояние: [В РАЗРАБОТКЕ]

+++Ссылки раздела
* ГлоссарийОператор


+++Содержание раздела



+++Материалы
* Завершение приложения - процесс, обратный запуску, но не совсем.
* Приложение вызывает функцию движка StorageClose().
* Если Хранилище было открыто в режиме не readOnly:
    * Надо обновить свойства Хранилища, подсчитав статистику хранилища 
    * Надо обновить версию Хранилища, добавив 1 в поле Build объекта версии Хранилища в объекте свойств Хранилища.
        * если в Хранилище были произведены изменения: в БД или FSM нужно ввести флаги Изменено. А если изменений не было, то и незачем версию Хранилища обновлять.
        * пока проще каждый раз обновлять версию Хранилища, чем караулить эти изменения. Но надо запланировать список мест для такого, и проблем вроде добавляемых пользователем файлов материалов.
    * Надо перезаписать Файл свойств Хранилища на эти обновленные свойства Хранилища.
* Движок закрывает все подсистемы в правильном порядке, вызывая изх функции Close() при наличии. То есть, менеджер ид элементов, адаптер БД, объект свойств Хранилища, менеджер каталога Хранилища, итп?
* БД всегда нормально должна быть закрытой, чтобы избежать повреждения во время работы приложения. Но если повреждение возникнет при аварийном завершении приложения, пользователь должен сам заменить файл Бд его бекап-копией. При этом, он потеряет изменения за прошлый сеанс, но это все же не целиком все данные БД. 

